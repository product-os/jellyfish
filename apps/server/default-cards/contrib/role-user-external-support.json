{
  "slug": "role-user-external-support",
  "name": "External support user role permissions",
  "version": "1.0.0",
  "type": "role",
  "markers": [],
  "tags": [],
  "links": {},
  "requires": [],
  "capabilities": [],
  "active": true,
  "data": {
    "read": {
      "type": "object",
      "required": [
        "active"
      ],
      "properties": {
        "active": {
          "type": "boolean",
          "const": true
        }
      },
      "anyOf": [
        {
          "type": "object",
          "additionalProperties": true,
          "required": [ "type" ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "link",
                "link@1.0.0"
              ]
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": true,
          "required": [ "type", "markers" ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "create",
                "message",
                "support-thread",
                "create@1.0.0",
                "message@1.0.0",
                "support-thread@1.0.0"
              ]
            },
            "markers": {
              "type": "array",
              "contains": {
                "const": {
                  "$eval": "user.slug + '+org-balena'"
                }
              },
              "maxItems": 1,
              "minItems": 1
            }
          }
        },
        {
          "type": "object",
          "required": [
            "slug",
            "type",
            "data"
          ],
          "properties": {
            "slug": {
              "type": "string",
              "enum": [
                "card",
                "link",
                "message",
                "support-thread"
              ]
            },
            "type": {
              "type": "string",
              "enum": [ "type", "type@1.0.0" ]
            },
            "data": {
              "type": "object",
              "additionalProperties": true
            }
          }
        },
        {
          "type": "object",
          "required": [ "id", "slug", "type", "data" ],
          "properties": {
            "id": {
              "type": "string"
            },
            "slug": {
              "type": "string",
              "enum": [
                "action-create-session",
                "action-create-card",
                "action-create-event",
                "action-oauth-associate"
              ]
            },
            "type": {
              "type": "string",
              "enum": [ "action", "action@1.0.0" ]
            },
            "data": {
              "type": "object",
              "additionalProperties": true
            }
          }
        },
        {
          "type": "object",
          "required": [ "type", "data" ],
          "additionalProperties": true,
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "execute",
                "session",
                "execute@1.0.0",
                "session@1.0.0"
              ]
            },
            "data": {
              "type": "object",
              "additionalProperties": true,
              "required": [ "actor" ],
              "properties": {
                "actor": {
                  "type": "string",
                  "const": {
                    "$eval": "user.id"
                  }
                }
              }
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": true,
          "required": [ "slug", "type", "data" ],
          "properties": {
            "slug": {
              "type": "string",
              "const": {
                "$eval": "user.slug"
              }
            },
            "type": {
              "type": "string",
              "enum": [ "user", "user@1.0.0" ]
            },
            "data": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "email": {
                  "type": [ "string", "array" ]
                },
                "hash": {
                  "type": "string"
                },
                "avatar": {
                  "type": [ "string", "null" ]
                },
                "oauth": {
                  "type": "object",
                  "additionalProperties": true
                },
                "profile": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        }
      ]
    }
  }
}
